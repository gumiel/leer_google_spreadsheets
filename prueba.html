<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
    
  <script
  src="jquery.csv.js"></script>
  <script>
    $(document).ready(function(){
        $.ajax({
            url: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQD32FS1_p5_js5xJOAHO35K0ush1nVVHpld19TOAdO3BJEXMKDjgdO_rIcOx-iB4hUi5EeokR_qaIZ/pub?output=csv',
            dataType: 'text',
        }).done(function(res){
            // successFunction(res)
            var data = $.csv.toObjects(res);
            console.log(data);
        });
    });



    function successFunction(data) {
        var allRows = data.split(/r?n|r/);
        var table = '<table>';
        for (var singleRow = 0; singleRow < allRows.length; singleRow++) {
            if (singleRow === 0) {
            table += '<thead>';
            table += '<tr>';
            } else {
            table += '<tr>';
            }
            var rowCells = allRows[singleRow].split(',');
            for (var rowCell = 0; rowCell < rowCells.length; rowCell++) {
            if (singleRow === 0) {
                table += '<th>';
                table += rowCells[rowCell];
                table += '</th>';
            } else {
                table += '<td>';
                table += rowCells[rowCell];
                table += '</td>';
            }
            }
            if (singleRow === 0) {
            table += '</tr>';
            table += '</thead>';
            table += '<tbody>';
            } else {
            table += '</tr>';
            }
        } 
        table += '</tbody>';
        table += '</table>';
        $('body').append(table);
        }
  </script>
</head>
<body>
    
</body>
</html>